<div class="container">
  <div class="search-container">
    <div>
      <p-iconField iconPosition="left">
        <p-inputIcon styleClass="pi pi-search" />
        <input
          type="text"
          style="border-radius: 1rem"
          pInputText
          placeholder="Search"
          (input)="searchValue($event.target)"
        />
      </p-iconField>
    </div>
    <div style="margin-left: 2rem">
      <p-dropdown
        [options]="companyList"
        id="companyName"
        [(ngModel)]="selectedCompany"
        optionLabel="companyName"
        [filter]="true"
        filterBy="companyName"
        [showClear]="true"
        placeholder="Select a company"
        (onChange)="onChangeproductDetailsByCompanyId($event.value)"
      >
        <ng-template pTemplate="selectedItem" let-selectedOption>
          <div class="flex align-items-center gap-2">
            <div>{{ selectedOption.companyName }}</div>
          </div>
        </ng-template>
        <ng-template let-company pTemplate="item">
          <div class="flex align-items-center gap-2">
            <div>{{ company.companyName }}</div>
          </div>
        </ng-template>
      </p-dropdown>
    </div>
    <div style="margin-left: 2rem">
      <p-button
        label="Add Product"
        [text]="true"
        [raised]="true"
        severity="warning"
        (click)="addRecord()"
      />
    </div>
    <div style="margin-left: 2rem">
      <p-fileUpload
        #fileUpload
        mode="basic"
        accept=".xlsx,.xls"
        [maxFileSize]="1000000"
        label="Import"
        chooseLabel="Import"
        class="mr-2 inline-block"
        (onSelect)="onFileSelect($event)"
      >
      </p-fileUpload>
    </div>
    <div style="margin-left: 2rem">
      <p-button
        label="Export Data"
        (click)="exportData()"
        [text]="true"
        [raised]="true"
        [plain]="true"
      />
    </div>
  </div>
  <div class="table-container">
    <p-table
      [value]="products"
      [loading]="loading"
      [paginator]="true"
      [rows]="5"
      [tableStyle]="{ 'min-width': '60rem' }"
      [rowsPerPageOptions]="[5, 10]"
    >
      <ng-template pTemplate="header">
        <tr>
          <th pSortableColumn="productName" style="width: 30%">
            Product Name <p-sortIcon field="productName" />
          </th>
          <th pSortableColumn="mrp" style="width: 15%">
            MRP <p-sortIcon field="mrp" />
          </th>
          <th pSortableColumn="quantity" style="width: 15%">
            Quantity <p-sortIcon field="quantity" />
          </th>
          <th pSortableColumn="doExpiry" style="width: 20%">
            Expiry Date <p-sortIcon field="doExpiry" />
          </th>
          <th pSortableColumn="selectedWarehouse" style="width: 10%">
            Warehouse <p-sortIcon field="selectedWarehouse" />
          </th>
          <th style="width: 10%">Actions</th>
        </tr>
      </ng-template>
      <ng-template pTemplate="body" let-product>
        <tr>
          <td>{{ product.productName }}</td>
          <td>{{ product.mrp }}</td>
          <td>{{ product.quantity }}</td>
          <td>{{ product.doExpiry | date : "MMM-yyyy" }}</td>
          <td>{{ product.selectedWarehouse }}</td>
          <td>
            <div class="table-action-partition">
              <button
                type="button"
                pButton
                pRipple
                icon="pi pi-pencil"
                (click)="selectDataById(product._id)"
              ></button>
              <button
                type="button"
                severity="danger"
                pButton
                pRipple
                icon="pi pi-trash"
                (click)="deleteDataById(product._id)"
              ></button>
            </div>
          </td>
        </tr>
      </ng-template>
      <ng-template pTemplate="emptymessage">
        <tr>
          <td colspan="6">No Product found.</td>
        </tr>
      </ng-template>
    </p-table>
  </div>
  <div style="margin-top: 1rem">
    <p-messages
      [(value)]="messages"
      [enableService]="false"
      [closable]="false"
    ></p-messages>
  </div>
</div>
